define(["services/services","config"],function(e,t){e.factory("Environment",function(e,n,r,i,s){var o=n(),u=n(t.host+"/:first",{},{get:{method:"GET",params:{first:"geofence"}},save:{method:"PUT",params:{first:"geofence"}}});return o.prototype.domain=function(){return i._("domain").then(function(t){var n=t.data[0];return s("environment").save("domain",n),e.app.environment.domain=n,n})},o.prototype.geofence=function(){var t=r.defer();return u.get(function(n){s("environment").save("geofence",n),e.app.environment.geofence=n,console.log(n),t.resolve(n)},function(e){t.resolve({error:e})}),t.promise},o.prototype.saveGeofence=function(e){var t=r.defer();return u.save(e,function(e){t.resolve(e)},function(e){t.resolve({error:e})}),t.promise},o.prototype.setup=function(){var e=r.defer(),t=[o.prototype.domain(),o.prototype.geofence()];try{r.all(t).then(function(t){e.resolve(t),console.log(t)})}catch(n){console.log("Something wrong with setting up domain and geofence : "+n)}return e.promise},new o})});