define(["controllers/controllers"],function(e){e.controller("login",["$scope","$rootScope","$q","$location","$timeout","Session","Storage","Store","$routeParams","UserCall","md5","Environment",function(e,t,n,r,i,s,o,u,a,f,l,c){function p(t,n){f.login(t,n).then(function(t){if(t.error&&t.error.status)return e.alert={login:{display:!0,message:t.error.status==400||t.error.status==403||t.error.status==404?"Wrong username or password!":"There has been an error with your login!"}},!1;v()})}function d(){f.resources().then(function(e){c.setup().then(function(e){e||console.warn("error ",e)})})}function v(){d(),m()}function m(){r.path("/domains")}e.login={},e.alert={login:{display:!1,message:""}},angular.element(".navbar").hide(),angular.element(".topbar").hide();var h=u("environment").get("logindata");h&&h.remember&&(e.logindata=h),e.auth=function(){u("user").nuke(),u("environment").nuke(),o.clearAll(),o.session.clearAll();if(!e.logindata||!e.logindata.username||!e.logindata.password)return e.alert={login:{display:!0,message:t.ui.login.alert_fillfiled}},!1;u("environment").save("logindata",{username:e.logindata.username,password:e.logindata.password,remember:e.logindata.remember}),u("environment").save("askPass",l.createHash(e.logindata.password)),p(e.logindata.username,e.logindata.password)}}])});